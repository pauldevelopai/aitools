{% extends "admin/base.html" %}

{% block title %}{{ tool.name }} Playbook{% endblock %}

{% block content %}
        <!-- Breadcrumb -->
        <div class="mb-6 text-sm">
            <a href="/admin/playbooks/kit-tools" class="text-blue-600 hover:text-blue-800">&larr; Kit Tools Playbooks</a>
        </div>

        <!-- Page Header -->
        <div class="bg-white rounded-lg shadow p-6 mb-6">
            <div class="flex justify-between items-start">
                <div>
                    <h1 class="text-2xl font-bold text-gray-900">{{ tool.name }}</h1>
                    <p class="text-gray-600 mt-1">{{ tool.purpose or tool.description[:200] }}</p>
                    <div class="mt-3 flex gap-2 text-sm">
                        <span class="px-3 py-1 rounded-full bg-blue-100 text-blue-800">{{ tool.cluster_name }}</span>
                        <span class="px-3 py-1 rounded-full {% if tool.cdi_scores.cost <= 3 %}bg-green-100 text-green-700{% else %}bg-gray-100 text-gray-700{% endif %}">
                            Cost: {{ tool.cdi_scores.cost }}/10
                        </span>
                        <span class="px-3 py-1 rounded-full {% if tool.cdi_scores.difficulty <= 3 %}bg-green-100 text-green-700{% else %}bg-gray-100 text-gray-700{% endif %}">
                            Difficulty: {{ tool.cdi_scores.difficulty }}/10
                        </span>
                        <span class="px-3 py-1 rounded-full {% if tool.cdi_scores.invasiveness <= 3 %}bg-green-100 text-green-700{% else %}bg-gray-100 text-gray-700{% endif %}">
                            Invasiveness: {{ tool.cdi_scores.invasiveness }}/10
                        </span>
                    </div>
                </div>
                <div class="flex items-center gap-3">
                    {% if playbook %}
                        {% if playbook.status == 'draft' %}
                        <span class="px-3 py-1 text-sm font-medium rounded-full bg-yellow-100 text-yellow-800">Draft</span>
                        {% elif playbook.status == 'published' %}
                        <span class="px-3 py-1 text-sm font-medium rounded-full bg-green-100 text-green-800">Published</span>
                        {% endif %}
                    {% else %}
                    <form action="/admin/playbooks/kit-tools/{{ tool.slug }}/create" method="POST">
                        <button type="submit" class="px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700">
                            Create Playbook
                        </button>
                    </form>
                    {% endif %}
                    <a href="/tools/{{ tool.slug }}" target="_blank" class="px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200">
                        View Tool Page
                    </a>
                </div>
            </div>
        </div>

        {% if playbook %}
        <!-- Edit Form -->
        <form action="/admin/playbooks/kit-tools/{{ tool.slug }}/update" method="POST">
            <div class="space-y-6">
                <!-- Best Use Cases -->
                <div class="bg-white rounded-lg shadow p-6">
                    <h2 class="text-lg font-semibold text-gray-900 mb-2">Best Use Cases for Newsrooms</h2>
                    <p class="text-sm text-gray-500 mb-4">When should journalists use this tool? What workflows does it fit best?</p>
                    <textarea name="best_use_cases" rows="6" class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm"
                              placeholder="e.g., Ideal for transcribing long-form interviews. Works well for...">{{ playbook.best_use_cases or '' }}</textarea>
                </div>

                <!-- Implementation Steps -->
                <div class="bg-white rounded-lg shadow p-6">
                    <h2 class="text-lg font-semibold text-gray-900 mb-2">Implementation Steps</h2>
                    <p class="text-sm text-gray-500 mb-4">How should a newsroom implement this tool? Step-by-step guidance.</p>
                    <textarea name="implementation_steps" rows="8" class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm"
                              placeholder="1. Sign up for an account...&#10;2. Configure settings...&#10;3. Test with sample data...">{{ playbook.implementation_steps or '' }}</textarea>
                </div>

                <!-- Common Mistakes -->
                <div class="bg-white rounded-lg shadow p-6">
                    <h2 class="text-lg font-semibold text-gray-900 mb-2">Common Mistakes / Risks</h2>
                    <p class="text-sm text-gray-500 mb-4">What should newsrooms avoid? Common pitfalls and how to prevent them.</p>
                    <textarea name="common_mistakes" rows="5" class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm"
                              placeholder="e.g., Don't upload sensitive source material without...">{{ playbook.common_mistakes or '' }}</textarea>
                </div>

                <!-- Privacy Notes -->
                <div class="bg-white rounded-lg shadow p-6">
                    <h2 class="text-lg font-semibold text-gray-900 mb-2">Privacy & Source Protection</h2>
                    <p class="text-sm text-gray-500 mb-4">Data handling, source protection considerations, GDPR compliance notes.</p>
                    <textarea name="privacy_notes" rows="5" class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm"
                              placeholder="e.g., Data is processed on servers in... Source material should be...">{{ playbook.privacy_notes or '' }}</textarea>
                </div>

                <!-- What It Replaces/Improves -->
                <div class="bg-white rounded-lg shadow p-6">
                    <h2 class="text-lg font-semibold text-gray-900 mb-2">What This Replaces or Improves</h2>
                    <p class="text-sm text-gray-500 mb-4">What manual processes or older tools does this replace?</p>
                    <textarea name="replaces_improves" rows="3" class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm"
                              placeholder="e.g., Replaces manual transcription. Faster than...">{{ playbook.replaces_improves or '' }}</textarea>
                </div>

                <!-- Pricing Summary -->
                <div class="bg-white rounded-lg shadow p-6">
                    <h2 class="text-lg font-semibold text-gray-900 mb-2">Pricing for Newsrooms</h2>
                    <p class="text-sm text-gray-500 mb-4">Pricing tiers, free plans, newsroom discounts, cost per usage.</p>
                    <textarea name="pricing_summary" rows="4" class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm"
                              placeholder="e.g., Free tier: 60 min/month. Pro: $10/month for...">{{ playbook.pricing_summary or '' }}</textarea>
                </div>

                <!-- Integration Notes -->
                <div class="bg-white rounded-lg shadow p-6">
                    <h2 class="text-lg font-semibold text-gray-900 mb-2">Integrations</h2>
                    <p class="text-sm text-gray-500 mb-4">How does this integrate with common newsroom tools? CMS, Slack, Google Drive, etc.</p>
                    <textarea name="integration_notes" rows="4" class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm"
                              placeholder="e.g., Integrates with Google Drive, Slack notifications...">{{ playbook.integration_notes or '' }}</textarea>
                </div>

                <!-- Actions -->
                <div class="flex justify-between">
                    <button type="submit" class="px-6 py-3 bg-blue-600 text-white rounded-md hover:bg-blue-700 font-medium">
                        Save Changes
                    </button>

                    {% if playbook.status == 'draft' %}
                    <form action="/admin/playbooks/kit-tools/{{ tool.slug }}/publish" method="POST" class="inline">
                        <button type="submit" class="px-6 py-3 bg-green-600 text-white rounded-md hover:bg-green-700 font-medium">
                            Publish Playbook
                        </button>
                    </form>
                    {% endif %}
                </div>
            </div>
        </form>

        {% else %}
        <!-- No Playbook Yet -->
        <div class="bg-white rounded-lg shadow p-12 text-center">
            <div class="text-4xl mb-4">ðŸ“–</div>
            <h2 class="text-xl font-semibold text-gray-700 mb-2">No Playbook Yet</h2>
            <p class="text-gray-500 mb-6">Create a playbook to provide newsroom implementation guidance for this tool.</p>
            <form action="/admin/playbooks/kit-tools/{{ tool.slug }}/create" method="POST">
                <button type="submit" class="px-6 py-3 bg-green-600 text-white rounded-md hover:bg-green-700 font-medium">
                    Create Playbook
                </button>
            </form>
        </div>
        {% endif %}
{% endblock %}
